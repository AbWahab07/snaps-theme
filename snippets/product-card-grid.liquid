{%- assign has_badge = false -%}

{%- if product.tags contains 'new' -%}
  {%- assign has_badge = true -%}
  {%- assign badge_type = 'new' -%}
  {%- assign badge_text = "NEW" -%}
{%- endif -%}

{%- for tag in product.tags -%}
  {%- assign tag_parts = tag | split: ':' -%}
  {%- if tag_parts[0] == 'limited' -%}
    {%- assign has_badge = true -%}
    {%- assign badge_type = 'limited' -%}
    
    {%- if tag_parts[1] != blank -%}
      {%- capture badge_text -%}
        LIMITED EDITION OF {{tag_parts[1] | strip }}
      {%- endcapture -%}
    {%- else -%}
      {%- assign badge_text = "LIMITED EDITION" -%}
    {%- endif -%}
  {%- endif -%}
{%- endfor -%}

{%- if product.tags contains 'soldout' -%}
  {%- assign has_badge = true -%}
  {%- assign badge_type = 'soldout' -%}
  {%- assign badge_text = "SOLD OUT" -%}
{%- endif -%}

<a class="grid-view-item__link grid-view-item__image-container" href="{{ product.url | within: collection }}">
  <div class="grid-view-item">
    <span class="visually-hidden">{{ product.title }}</span>
    {%- if has_badge -%}
    <div class="product-badge {{badge_type}}">
      {{badge_text}}
    </div>
    {%- endif -%}
    <div class="grid-view-item__image-wrapper product-card__image-wrapper js">
      <img class="grid-view-item__image lazyload product-card__image"
        src="{{ product.featured_image | img_url: '300x300' }}"
        data-src="{{ img_url }}"
        data-widths="[180, 360, 540, 720, 900, 1080, 1296, 1512, 1728, 2048]"
        data-aspectratio="{{ product.featured_image.aspect_ratio }}"
        data-sizes="auto"
        alt="">
    </div>
    <div class="product-card__info">
      {% if section.settings.show_vendor %}
      <div class="price__vendor">
        <span class="visually-hidden">{{ 'products.product.vendor' | t }}</span>
        {{ product.vendor }}
      </div>
      {% endif %}
      <h6 class="grid-view-item__title product-card__title" aria-hidden="true">{{ product.title }}</h6>
      {% include 'product-price', variant: product %}
    </div>
  </div>
</a>
